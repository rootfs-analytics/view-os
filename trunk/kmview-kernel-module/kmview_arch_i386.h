#ifndef KMVIEW_ARCH_I386_H
#define KMVIEW_ARCH_I386_H
#include <linux/utrace.h>

#ifndef BITS_PER_LONG
#error "BITS_PER_LONG undefined"
#endif

#define PATHSYSCALL { 0x4001c720,0x000001c2,0x10280000,0x00000c08,0x00000000,0x00400000,0x0010005a,0x00001b6c,0x00009000,0x000fff80,0x00000001,0x00000000}
#define PATH0SYSCALL { 0x4001c520,0x00000182,0x10200000,0x00000c08,0x00000000,0x00400000,0x0010005a,0x00001b6c,0x00009000,0x00000000,0x00000000,0x00000000}
#define PATH1SYSCALL { 0x00000200,0x00000040,0x00080000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x000e3f80,0x00000001,0x00000000}
#define PATH2SYSCALL { 0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00010000,0x00000000,0x00000000}
#define PATH3SYSCALL { 0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x0000c000,0x00000000,0x00000000}
#define ATSYSCALL { 0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x000fef80,0x00000001,0x00000000}
#define SELECTPOLLSYSCALL { 0x00000000,0x00000000,0x00040000,0x00000000,0x00004000,0x00000100,0x00000000,0x00000000,0x00000000,0x00300000,0x00000000,0x00000000}
#define FDSYSCALL { 0x10080058,0x00c00000,0xe2000000,0x00401010,0x0016b020,0x00300000,0x30008024,0x04002492,0x00012000,0x000c1c00,0x00000000,0x00000000}

#define MAXERR 4096
#define arch_scno(X) ((X)->orig_ax)
#define arch_n(X,N) (*(((long *)(X))+(N)))
#define arch_sp(X) ((X)->sp)
#define arch_pc(X) ((X)->ip)
#define arch_get_rv(X) ({ int ax; \
		    ax = (X)->ax;\
		    (ax<0 && -ax < MAXERR)? -1 : ax; })
#define arch_get_errno(X) ({ int ax; \
		    ax = (X)->ax;\
		    (ax<0 && -ax < MAXERR)? -ax : 0; })
#define arch_put_rv_errno(X,RV,ERRNO) ({if ((ERRNO) != 0) {\
		if ((ERRNO) < 0) (ERRNO)=-ERRNO;\
		(X)->ax=-(ERRNO); } else\
		(X)->ax=(RV); })

#endif
